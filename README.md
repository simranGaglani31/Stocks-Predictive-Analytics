# Stocks-Predictive-Analytics
The code retrieves stock data for three industries using APIs, calculates portfolio metrics, generates plots of stock prices and portfolio revenue, and finally snapshots the data and plots it in Excel files on a desktop

The provided R code is a comprehensive analysis tool for stock data from three distinct industries: Tech, Health, and Retail. The code utilizes various libraries, including tidyquant, tidyverse, timetk, and openxlsx, to facilitate data manipulation, visualization, and working with time series data.

The code starts by retrieving historical stock data for a predefined set of stocks within each industry. For the Tech industry, the code fetches data for symbols such as AAPL, GOOG, NFLX, and NVDA. Similarly, it retrieves data for TDOC, PFE, MRNA, and CVS for the Health industry, and LULU, TGT, WMT, and CRI for the Retail industry. The data is obtained for a specific time range, from July 30th, 2021, to October 30th, 2021, using the tq_get function.

Once the data is retrieved, the code performs calculations to determine portfolio metrics for each industry. It generates random values for the number of units and the price at which each stock was bought within a certain range. Using these values, the code calculates the portfolio cost, portfolio price, and portfolio revenue for each stock in the industry. The results are stored in separate data frames: tech_stocks for the Tech industry, health_stocks for the Health industry, and retail_stocks for the Retail industry.

Next, the code creates line plots to visualize the stock prices and portfolio revenue over time for each industry. It utilizes the plot_time_series function from the tidyquant library. The resulting plots are stored in separate objects: tech_plot for the Tech industry, health_plot for the Health industry, and retail_plot for the Retail industry. These plots provide a visual representation of the performance and revenue generated by the stocks within each industry throughout the specified time range.

To facilitate further analysis and documentation, the code generates an Excel workbook using the openxlsx library. It creates separate worksheets within the workbook for each industry: "Stock_Anysis_Tech" for the Tech industry, "Stock_Anysis_Health" for the Health industry, and "Stock_Anysis_Retail" for the Retail industry. The code inserts the corresponding line plots and data tables into their respective worksheets in the workbook.

Furthermore, the code writes the stock data (including symbol, date, adjusted price, and portfolio revenue) into the corresponding worksheets within the workbook. This ensures that all the necessary information is readily available for further analysis or reporting purposes.

Finally, the code saves the workbook as an Excel file in a specified folder. Each industry has its own Excel file: "Stock_Anysis_Tech.xlsx" for the Tech industry, "Stock_Anysis_Health.xlsx" for the Health industry, and "Stock_Anysis_Retail.xlsx" for the Retail industry. These files serve as snapshots in time, capturing the portfolio performance and stock data for each industry over the four-month period.
